<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WCST Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f5f5f5;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }
        h1 {
            text-align: center;
        }
        .card-container {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
        }
        .card {
            width: 100px;
            height: 150px;
            border: 2px solid #333;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            cursor: pointer;
            transition: transform 0.2s;
        }
        .card:hover {
            transform: scale(1.1);
        }
        .message {
            margin-top: 20px;
            font-size: 18px;
        }
        .score {
            margin-top: 10px;
            font-size: 16px;
        }
        button {
            margin-top: 20px;
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
            border: none;
            border-radius: 6px;
            background-color: #007bff;
            color: white;
        }
    </style>
</head>
<body>

<h1>Wisconsin Card Sorting Test (WCST)</h1>
<p>Sort the target card by <strong>color, shape, or number</strong>. Try to figure out the current rule!</p>

<div id="targetCard" class="card">?</div>

<div class="card-container">
    <div class="card" id="card1"></div>
    <div class="card" id="card2"></div>
    <div class="card" id="card3"></div>
    <div class="card" id="card4"></div>
</div>

<div class="message" id="message">Select a card to start.</div>
<div class="score" id="score">Score: 0 | Correct: 0 | Incorrect: 0</div>
<button onclick="restartTest()">Restart Test</button>

<script>
    const colors = ["red", "green", "blue", "yellow"];
    const shapes = ["★", "●", "■", "▲"];
    const numbers = [1, 2, 3, 4];

    let rule = "";
    let score = 0;
    let correct = 0;
    let incorrect = 0;

    function randomChoice(arr) {
        return arr[Math.floor(Math.random() * arr.length)];
    }

    function generateCard() {
        return {
            color: randomChoice(colors),
            shape: randomChoice(shapes),
            number: randomChoice(numbers)
        };
    }

    function displayCard(card, elementId) {
        const el = document.getElementById(elementId);
        el.style.color = card.color;
        el.textContent = card.shape.repeat(card.number);
    }

    function newTargetCard() {
        const target = generateCard();
        displayCard(target, "targetCard");
        return target;
    }

    function newRule() {
        const rules = ["color", "shape", "number"];
        rule = randomChoice(rules);
        console.log("Current rule:", rule); // للمطور، يمكن حذفه لاحقاً
    }

    let targetCard = newTargetCard();
    newRule();

    const cardElements = ["card1", "card2", "card3", "card4"];
    let currentCards = [];

    function setupCards() {
        currentCards = [];
        cardElements.forEach(id => {
            const card = generateCard();
            currentCards.push(card);
            displayCard(card, id);
        });
    }

    setupCards();

    cardElements.forEach((id, index) => {
        document.getElementById(id).addEventListener("click", () => {
            const selectedCard = currentCards[index];
            score++;
            if (selectedCard[rule] === targetCard[rule]) {
                correct++;
                document.getElementById("message").textContent = "Correct!";
                targetCard = newTargetCard();
                newRule();
            } else {
                incorrect++;
                document.getElementById("message").textContent = "Incorrect! Try again.";
            }
            setupCards();
            updateScore();
        });
    });

    function updateScore() {
        document.getElementById("score").textContent = `Score: ${score} | Correct: ${correct} | Incorrect: ${incorrect}`;
    }

    function restartTest() {
        score = 0;
        correct = 0;
        incorrect = 0;
        targetCard = newTargetCard();
        newRule();
        setupCards();
        updateScore();
        document.getElementById("message").textContent = "Select a card to start.";
    }
</script>

</body>
</html>
